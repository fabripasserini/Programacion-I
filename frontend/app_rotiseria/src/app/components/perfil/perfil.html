<app-back></app-back>

<div class="container mt-4 mb-5">
  <!--  T铆tulo Centrado -->
  <div class="text-center mb-4">
    <h2 class="fw-bold mb-3">
      <i class="fa-solid fa-user-circle"></i> Mi Perfil
    </h2>
    
    <!-- Bot贸n Editar Perfil centrado -->

    
  </div>

  @if (usuario) {
    
    <!--  Informaci贸n del usuario -->
    <div class="card shadow-sm">
      <div class="card-body">

        <!-- Modo Visualizaci贸n -->
        @if (!modoEdicion) {
          
          <!-- Avatar y rol -->
          <div class="text-center mb-4">
            <div class="avatar-circle mx-auto mb-3">
              <i class="fa-solid fa-user fa-3x"></i>
            </div>
            <h4 class="fw-bold mb-2">{{ usuario.nombre }} {{ usuario.apellido }}</h4>
            <span class="badge bg-{{ getRolColor(usuario.rol) }}">
              {{ getRolNombre(usuario.rol) }}
            </span>
          </div>

          <hr>

          <!-- Informaci贸n personal -->
          <div class="row g-3">
            
            <div class="col-md-6">
              <div class="info-item">
                <i class="fa-solid fa-envelope text-primary"></i>
                <div>
                  <small class="text-muted d-block">Email</small>
                  <strong>{{ usuario.email }}</strong>
                </div>
              </div>
            </div>

            <div class="col-md-6">
              <div class="info-item">
                <i class="fa-solid fa-phone text-success"></i>
                <div>
                  <small class="text-muted d-block">Tel茅fono</small>
                  <strong>{{ usuario.telefono || 'No especificado' }}</strong>
                </div>
              </div>
            </div>

            <div class="col-md-6">
              <div class="info-item">
                <i class="fa-solid fa-calendar text-info"></i>
                <div>
                  <small class="text-muted d-block">Miembro desde</small>
                  <strong>{{ usuario.created_at | date:'yyyy-MM-dd' }}</strong>
                </div>
              </div>
            </div>

            <div class="col-md-6">
              <div class="info-item">
                <i class="fa-solid fa-id-card text-warning"></i>
                <div>
                  <small class="text-muted d-block">ID de Usuario</small>
                  <strong>#{{ usuario.id }}</strong>
                </div>
              </div>
            </div>

          </div>

        }

        <!-- Modo Edici贸n -->
        @if (modoEdicion) {

          <form>
            
            <div class="row g-3">
              
              <div class="col-md-6">
                <label class="form-label fw-bold">Nombre</label>
                <input 
                  type="text" 
                  class="form-control" 
                  [(ngModel)]="usuarioEditado.nombre"
                  name="nombre"
                  placeholder="Tu nombre"
                >
              </div>

              <div class="col-md-6">
                <label class="form-label fw-bold">Apellido</label>
                <input 
                  type="text" 
                  class="form-control" 
                  [(ngModel)]="usuarioEditado.apellido"
                  name="apellido"
                  placeholder="Tu apellido"
                >
              </div>

              <div class="col-md-6">
                <label class="form-label fw-bold">Email</label>
                <input 
                  type="email" 
                  class="form-control" 
                  [(ngModel)]="usuarioEditado.email"
                  name="email"
                  placeholder="tu@email.com"
                >
              </div>

              <div class="col-md-6">
                <label class="form-label fw-bold">Tel茅fono</label>
                <input 
                  type="tel" 
                  class="form-control" 
                  [(ngModel)]="usuarioEditado.telefono"
                  name="telefono"
                  placeholder="+54 261 123-4567"
                >
              </div>

            </div>

            <hr class="my-4">

            <!-- Botones de acci贸n -->
            <div class="d-flex gap-2">
              <button 
                type="button" 
                class="btn btn-success flex-fill"
                (click)="guardarCambios()"
              >
                <i class="fa-solid fa-save"></i> Guardar Cambios
              </button>
              
              <button 
                type="button" 
                class="btn btn-secondary flex-fill"
                (click)="cancelarEdicion()"
              >
                <i class="fa-solid fa-times"></i> Cancelar
              </button>
            </div>

          </form>

        }

      </div>
    </div>

  } @else {
    <!-- Cargando -->
    <div class="text-center py-5">
      <div class="spinner-border text-primary" role="status">
        <span class="visually-hidden">Cargando...</span>
      </div>
      <p class="mt-3 text-muted">Cargando perfil...</p>
    </div>
  }

<div class="text-center mb-4 py-5">
   
    <!-- Bot贸n Editar Perfil centrado -->
    @if (!modoEdicion) {
      <button class="btn btn-primary" (click)="activarEdicion()">
        <i class="fa-solid fa-edit"></i> Editar Perfil
      </button>
    }
  </div>
<app-footerunico></app-footerunico>
</div>