<div class="main-content-wrapper">
    @if (getRol() === 'user'){
    <app-titulos 
        [titulo]="'Mis pedidos'">
    </app-titulos>}
    @else{
        <app-titulos 
        [titulo]="'Pedidos'">
    </app-titulos>
    }

    <!-- SISTEMA DE PESTAÑAS PARA ORGANIZAR EL CONTENIDO -->
    <ul class="mp-tabs" id="profileTabs" role="tablist">
  <li class="mp-tab-item" role="presentation">
    <button class="mp-tab-btn" [class.active]="activeTab === 'proceso'" (click)="onTabChange('proceso')" data-bs-toggle="tab" data-bs-target="#proceso" type="button" aria-controls="proceso" aria-selected="true">
      <span class="mp-tab-icon">⏳</span>
      <span class="mp-tab-label">En proceso</span>
    </button>
  </li>

  <li class="mp-tab-item" role="presentation">
    <button class="mp-tab-btn" [class.active]="activeTab === 'completado'" (click)="onTabChange('completado')" data-bs-toggle="tab" data-bs-target="#completados" type="button" aria-controls="completados" aria-selected="false">
      <span class="mp-tab-icon">✅</span>
      <span class="mp-tab-label">Completados</span>
    </button>
  </li>

  <li class="mp-tab-item" role="presentation">
    <button class="mp-tab-btn" [class.active]="activeTab === 'cancelado'" (click)="onTabChange('cancelado')" data-bs-toggle="tab" data-bs-target="#cancelados" type="button" aria-controls="cancelados" aria-selected="false">
      <span class="mp-tab-icon">✖️</span>
      <span class="mp-tab-label">Cancelados</span>
    </button>
  </li>
</ul>

    
    <!-- CONTENIDO DE LAS PESTAÑAS -->

<div class="d-flex flex-wrap justify-content-center align-items-center gap-2 mb-3">
          <select class="form-select form-select-sm me-2 w-auto" [(ngModel)]="criterioBusqueda">
          <option value=""> </option>
          <option value="productos">Cantidad de productos</option>
          <option value="sortby_productos">Productos</option>
          <option value="direccion">Direccion</option>
          <option value="id">ID pedido</option>
          <option value="fecha">Fecha</option>
          @if (getRol() === 'admin' || getRol() === 'empleado') {
          <option value="id_usuario">ID Usuario</option>
          }
        </select>

        @if (criterioBusqueda === 'fecha') {
            <div class="d-flex align-items-center gap-3 ms-2">

              <div>
                <label class="form-label mb-0 small text-muted">Desde</label>
                <input type="date" class="form-control form-control-sm rounded-3" 
                      [(ngModel)]="fechaInicio" name="fechaInicio">
              </div>

              <div>
                <label class="form-label mb-0 small text-muted">Hasta</label>
                <input type="date" class="form-control form-control-sm rounded-3" 
                      [(ngModel)]="fechaFin" name="fechaFin">
              </div>

            </div>
          }

          <input
          type="text"
          class="form-control form-control-sm me-2"
          placeholder="Buscar pedido..."
          [(ngModel)]="nombre"
          style="width: 180px;"
          (keyup.enter)="buscar()"
        />
        <button (click)="buscar()" class="btn btn-secondary" type="button">
          <i class="fa-solid fa-magnifying-glass"></i>
        </button>
        @if (getRol()==="user"){
        <a class="btn btn-primary ms-2" routerLink="/menu">
          <i class="fa-solid fa-plus"></i>
        </a>
      }
      </div>
<div class="tab-content">
  <div class="tab-pane fade" [class.show]="activeTab === 'proceso'" [class.active]="activeTab === 'proceso'" id="proceso">
    <app-lista-pedidos [pedidos]="pedidosEnProceso" estado="proceso"></app-lista-pedidos>
  </div>

  <div class="tab-pane fade" [class.show]="activeTab === 'completado'" [class.active]="activeTab === 'completado'" id="completados">
    <app-lista-pedidos [pedidos]="pedidosCompletados" estado="completado"></app-lista-pedidos>
  </div>

  <div class="tab-pane fade" [class.show]="activeTab === 'cancelado'" [class.active]="activeTab === 'cancelado'" id="cancelados">
    <app-lista-pedidos [pedidos]="pedidosCancelados" estado="cancelado"></app-lista-pedidos>
  </div>
</div>


<div class="d-flex justify-content-center mt-4">
        <nav>
          <ul class="pagination">
            <li class="page-item" [class.disabled]="paginationSvc.page === 1">
              <a class="page-link" href="#" (click)="onPageChange(paginationSvc.page - 1, $event)">&laquo;</a>
            </li>
            @for (page of getPages(); track page) {
              <li class="page-item" [class.active]="page === paginationSvc.page">
                <a class="page-link" href="#" (click)="onPageChange(page, $event)">{{ page }}</a>
              </li>
            }
            <li class="page-item" [class.disabled]="paginationSvc.page === paginationSvc.getTotalPages()">
              <a class="page-link" href="#" (click)="onPageChange(paginationSvc.page + 1, $event)">&raquo;</a>
            </li>
          </ul>
        </nav>
      </div>
